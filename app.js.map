{"version":3,"sources":["app/components/Legend.jsx","app/components/MonthSlider.jsx","app/components/NavMenu.jsx","app/components/NoumeaWaterQualityMap.jsx","app/components/OsmMap.jsx","app/initialize.jsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArFA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA1FA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7IA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3UA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7GA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvBA;AAAA","file":"public/app.js","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _underscore = require(\"underscore\");\n\nvar _underscore2 = _interopRequireDefault(_underscore);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Legend = function (_React$Component) {\n  _inherits(Legend, _React$Component);\n\n  function Legend(props) {\n    _classCallCheck(this, Legend);\n\n    var _this = _possibleConstructorReturn(this, (Legend.__proto__ || Object.getPrototypeOf(Legend)).call(this, props));\n\n    _this.state = { isExpanded: props.isExpanded };\n    return _this;\n  }\n\n  _createClass(Legend, [{\n    key: \"toggleExpanded\",\n    value: function toggleExpanded() {\n      this.setState({ isExpanded: !this.state.isExpanded });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var legend = this.props.legend;\n      var isExpanded = this.state.isExpanded;\n\n      return _react2.default.createElement(\n        \"div\",\n        { id: \"legend\", className: isExpanded ? 'expanded' : '' },\n        _react2.default.createElement(\n          \"button\",\n          { className: \"button expand-button\", onClick: function onClick() {\n              return _this2.toggleExpanded();\n            } },\n          isExpanded ? '-' : 'Légende'\n        ),\n        Object.entries(legend).map(function (_ref) {\n          var _ref2 = _slicedToArray(_ref, 2),\n              value = _ref2[0],\n              color = _ref2[1];\n\n          return _react2.default.createElement(\n            \"div\",\n            { className: \"legend-entry\", key: value },\n            _react2.default.createElement(\"div\", { className: \"color-block\", style: { backgroundColor: color } }),\n            _react2.default.createElement(\n              \"span\",\n              { className: \"legend-value\" },\n              value\n            )\n          );\n        })\n      );\n    }\n  }]);\n\n  return Legend;\n}(_react2.default.Component);\n\nexports.default = Legend;\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar MONTHS = ['Janvier', 'Février', 'Mars', 'Avril', 'Mai', 'Juin', 'Juillet', 'Août', 'Septembre', 'Octobre', 'Novembre', 'Décembre'];\n\nvar MonthSlider = function (_React$Component) {\n  _inherits(MonthSlider, _React$Component);\n\n  function MonthSlider(props) {\n    _classCallCheck(this, MonthSlider);\n\n    var _this = _possibleConstructorReturn(this, (MonthSlider.__proto__ || Object.getPrototypeOf(MonthSlider)).call(this, props));\n\n    _this.onChange = _this.onChange.bind(_this);\n\n    _this.input = null;\n    _this.state = { currentValue: _this.props.defaultIndex };\n    return _this;\n  }\n\n  _createClass(MonthSlider, [{\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      return _react2.default.createElement(\n        'div',\n        null,\n        _react2.default.createElement('input', { type: 'range', defaultValue: this.props.currentValue,\n          min: '0', max: this.props.values.length - 1,\n          onChange: this.onChange,\n          ref: function ref(_ref) {\n            return _this2.input = _ref;\n          }\n        }),\n        _react2.default.createElement(\n          'span',\n          { className: 'title is-5' },\n          this.indexToDateString(this.state.currentValue)\n        )\n      );\n    }\n  }, {\n    key: 'indexToDateString',\n    value: function indexToDateString(idx) {\n      if (!this.props.values) return '';\n      if (idx === -1) idx = this.props.values.length - 1;\n      var date = new Date(this.props.values[idx]);\n      return MONTHS[date.getMonth()] + ' ' + date.getFullYear();\n    }\n  }, {\n    key: 'onChange',\n    value: function onChange() {\n      this.setState({ currentValue: this.input.value });\n      var _props = this.props,\n          handleChange = _props.handleChange,\n          values = _props.values;\n\n      if (handleChange) handleChange(values[this.input.value]);\n    }\n  }]);\n\n  return MonthSlider;\n}(_react2.default.Component);\n\nexports.default = MonthSlider;\n\n\nMonthSlider.defaultProps = {\n  defaultIndex: 0,\n  values: [],\n  handleChange: null\n};\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require(\"react-dom\");\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar SHARING_ENCODED = \"https%3A%2F%2Fgoo.gl%2FJLV7jz%20Une%20map%20de%20la%20qualit%C3%A9%20de%20l%27eau%20des%20plages%20pour%20Noum%C3%A9a%20%F0%9F%87%B3%F0%9F%87%A8%F0%9F%90%99%F0%9F%90%AC%F0%9F%8F%8A\";\n\nvar NavMenu = function (_React$Component) {\n  _inherits(NavMenu, _React$Component);\n\n  function NavMenu() {\n    _classCallCheck(this, NavMenu);\n\n    return _possibleConstructorReturn(this, (NavMenu.__proto__ || Object.getPrototypeOf(NavMenu)).apply(this, arguments));\n  }\n\n  _createClass(NavMenu, [{\n    key: \"get_page_name_from_href\",\n    value: function get_page_name_from_href(href) {\n      var splitHref = href.split('/');\n      return splitHref[splitHref.length - 1];\n    }\n  }, {\n    key: \"get_active_link\",\n    value: function get_active_link(href, name) {\n      // Must be used only on a website without subdomains\n      var activePage = this.get_page_name_from_href(document.location.toString());\n      var linkPage = this.get_page_name_from_href(href);\n      var isActive = activePage == linkPage ? ' is-active' : '';\n      return _react2.default.createElement(\n        \"a\",\n        { href: href, className: \"nav-item \" + isActive },\n        name\n      );\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return _react2.default.createElement(\n        \"nav\",\n        { id: \"main-nav\", className: \"nav\" },\n        _react2.default.createElement(\n          \"div\",\n          { className: \"nav-left\" },\n          _react2.default.createElement(\n            \"a\",\n            { className: \"nav-item\" },\n            \"Noum\\xE9a - Qualit\\xE9 de l'eau des plages\"\n          )\n        ),\n        _react2.default.createElement(\n          \"span\",\n          { className: \"nav-toggle\" },\n          _react2.default.createElement(\"span\", null),\n          _react2.default.createElement(\"span\", null),\n          _react2.default.createElement(\"span\", null)\n        ),\n        _react2.default.createElement(\n          \"div\",\n          { className: \"nav-center nav-menu\" },\n          this.get_active_link(\"index.html\", \"Map\"),\n          this.get_active_link(\"about.html\", \"A propos\")\n        ),\n        _react2.default.createElement(\n          \"div\",\n          { className: \"nav-right nav-menu\" },\n          _react2.default.createElement(\n            \"span\",\n            { className: \"nav-item\" },\n            _react2.default.createElement(\n              \"a\",\n              { className: \"button is-small\",\n                href: \"https://twitter.com/intent/tweet?text=\" + SHARING_ENCODED },\n              _react2.default.createElement(\n                \"span\",\n                { className: \"icon is-small\" },\n                _react2.default.createElement(\"i\", { className: \"fa fa-twitter\" })\n              ),\n              _react2.default.createElement(\n                \"span\",\n                null,\n                \"Tweet\"\n              )\n            ),\n            _react2.default.createElement(\n              \"a\",\n              { className: \"button is-small\", href: \"https://www.facebook.com/sharer/sharer.php?u=https%3A//goo.gl/JLV7jz\" },\n              _react2.default.createElement(\n                \"span\",\n                { className: \"icon is-small\" },\n                _react2.default.createElement(\"i\", { className: \"fa fa-facebook\" })\n              ),\n              _react2.default.createElement(\n                \"span\",\n                null,\n                \"Share\"\n              )\n            ),\n            _react2.default.createElement(\n              \"a\",\n              { className: \"button is-small\", href: \"https://github.com/Betree/noumea-water-quality-map\" },\n              _react2.default.createElement(\n                \"span\",\n                { className: \"icon is-small\" },\n                _react2.default.createElement(\"i\", { className: \"fa fa-github\" })\n              ),\n              _react2.default.createElement(\n                \"span\",\n                null,\n                \"Fork\"\n              )\n            )\n          )\n        )\n      );\n    }\n  }]);\n\n  return NavMenu;\n}(_react2.default.Component);\n\nexports.default = NavMenu;\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require(\"react-dom\");\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _leaflet = require(\"leaflet\");\n\nvar _leaflet2 = _interopRequireDefault(_leaflet);\n\nvar _underscore = require(\"underscore\");\n\nvar _underscore2 = _interopRequireDefault(_underscore);\n\nvar _pegasus = require(\"@typicode/pegasus\");\n\nvar _pegasus2 = _interopRequireDefault(_pegasus);\n\nvar _color = require(\"color\");\n\nvar _color2 = _interopRequireDefault(_color);\n\nvar _OsmMap = require(\"./OsmMap\");\n\nvar _OsmMap2 = _interopRequireDefault(_OsmMap);\n\nvar _Legend = require(\"./Legend\");\n\nvar _Legend2 = _interopRequireDefault(_Legend);\n\nvar _MonthSlider = require(\"./MonthSlider\");\n\nvar _MonthSlider2 = _interopRequireDefault(_MonthSlider);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar GEOJSON_FILE = \"data/geojson/simple.geojson\";\nvar INITIAL_LOCATION = new _leaflet2.default.LatLng(-22.285, 166.45);\nvar BOUNDS = [[-22.35, 166.28], [-22.20, 166.61]];\nvar INITIAL_ZOOM = 14;\nvar DATE_FORMAT = \"\";\nvar POPUP_HISTORY_TABLE_SIZE = 20;\n\nvar STATUSES = [\"Inconnu\", \"Bon\", \"Moyen\", \"Mauvais\", \"Nécessite la fermeture de la baignade\"];\nvar STATUS_OUTDATED = STATUSES[0],\n    STATUS_GOOD = STATUSES[1],\n    STATUS_AVERAGE = STATUSES[2],\n    STATUS_BAD = STATUSES[3],\n    STATUS_DANGEROUS = STATUSES[4];\n\n\nvar COLORS = {};\nCOLORS[STATUS_GOOD] = \"#00afef\", COLORS[STATUS_AVERAGE] = \"#00af50\", COLORS[STATUS_BAD] = \"#e16b09\", COLORS[STATUS_DANGEROUS] = \"#ff0000\", COLORS[STATUS_OUTDATED] = \"#333333\";\n\nvar STATUSES_ICONS = {};\nSTATUSES_ICONS[STATUS_GOOD] = \"images/marker-good.png\", STATUSES_ICONS[STATUS_AVERAGE] = \"images/marker-average.png\", STATUSES_ICONS[STATUS_BAD] = \"images/marker-bad.png\", STATUSES_ICONS[STATUS_DANGEROUS] = \"images/marker-dangerous.png\", STATUSES_ICONS[STATUS_OUTDATED] = \"images/marker-outdated.png\";\n\nvar NoumeaWaterQualityMap = function (_React$Component) {\n  _inherits(NoumeaWaterQualityMap, _React$Component);\n\n  function NoumeaWaterQualityMap(props) {\n    _classCallCheck(this, NoumeaWaterQualityMap);\n\n    // Preload GeoJSON\n    var _this = _possibleConstructorReturn(this, (NoumeaWaterQualityMap.__proto__ || Object.getPrototypeOf(NoumeaWaterQualityMap)).call(this, props));\n\n    _this.geoJSONRequest = (0, _pegasus2.default)(GEOJSON_FILE);\n    _this.geoJSONRequest.overrideMimeType(\"application/json\");\n\n    _this.data = null;\n    _this.selectedDate = new Date();\n\n    _this.state = { dates: [] };\n    return _this;\n  }\n\n  _createClass(NoumeaWaterQualityMap, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return _react2.default.createElement(\n        \"div\",\n        null,\n        _react2.default.createElement(_OsmMap2.default, { initialLocation: INITIAL_LOCATION, initialZoom: INITIAL_ZOOM,\n          bounds: BOUNDS, minZoom: INITIAL_ZOOM,\n          ref: function ref(map) {\n            _this2.map = map;\n          },\n          initialMonth: new Date()\n        }),\n        _react2.default.createElement(_Legend2.default, { legend: COLORS, isExpanded: true }),\n        _react2.default.createElement(\n          \"div\",\n          { id: \"footer\" },\n          _react2.default.createElement(\n            \"div\",\n            { id: \"date-select-slider-container\" },\n            _react2.default.createElement(_MonthSlider2.default, { values: this.state.dates,\n              defaultIndex: this.state.dates.length - 1,\n              handleChange: function handleChange(date) {\n                return _this2.handleDateChange(date);\n              }\n            })\n          )\n        )\n      );\n    }\n  }, {\n    key: \"handleDateChange\",\n    value: function handleDateChange(date) {\n      this.selectedDate = date;\n      this.updateLayers();\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this3 = this;\n\n      this.geoJSONRequest.then(function (data, xhr) {\n        var pointToLayer = function pointToLayer(pt, pos) {\n          return _leaflet2.default.marker(pos, { title: pt.properties.name });\n        };\n        _this3.map.addGeoJson(data, { pointToLayer: pointToLayer });\n        _this3.setState({ dates: _this3.extractGeoJSONData(data) });\n        _this3.updateLayers();\n      },\n      // Error handler\n      function (data, xhr) {\n        console.log(data);\n      });\n    }\n  }, {\n    key: \"extractGeoJSONData\",\n    value: function extractGeoJSONData(data) {\n      var _this4 = this;\n\n      // Extract all dates\n      var dates = new Set();\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = data.features[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var feature = _step.value;\n\n          _underscore2.default.each(feature.properties.data, function (d) {\n            return dates.add(_this4.getYearMonthDateFromFrDatetimeStr(d.date).getTime());\n          });\n        }\n        // Convert & Sort them\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      dates = Array.from(dates).sort();\n      return _underscore2.default.map(dates, function (d) {\n        return new Date(d);\n      });\n    }\n  }, {\n    key: \"getYearMonthDateFromFrDatetimeStr\",\n    value: function getYearMonthDateFromFrDatetimeStr(datetimeStr) {\n      var _datetimeStr$split = datetimeStr.split(' '),\n          _datetimeStr$split2 = _slicedToArray(_datetimeStr$split, 1),\n          dateStr = _datetimeStr$split2[0];\n\n      var _dateStr$split = dateStr.split('/'),\n          _dateStr$split2 = _slicedToArray(_dateStr$split, 3),\n          day = _dateStr$split2[0],\n          month = _dateStr$split2[1],\n          year = _dateStr$split2[2];\n\n      return new Date(year, month - 1);\n    }\n  }, {\n    key: \"updateLayers\",\n    value: function updateLayers() {\n      var _this5 = this;\n\n      this.map.geoJSONLayer.eachLayer(function (layer) {\n        if (layer.feature.geometry.type === \"Point\") _this5.updateMarker(layer);else {\n          _this5.updateArea(layer);\n        }\n      });\n    }\n  }, {\n    key: \"updateArea\",\n    value: function updateArea(area) {\n      var _this6 = this;\n\n      var associatedPoints = _underscore2.default.filter(this.map.geoJSONLayer._layers, function (l) {\n        var _l$feature = l.feature,\n            type = _l$feature.geometry.type,\n            name = _l$feature.properties.name;\n\n        return type === \"Point\" && area.feature.properties.points.includes(name);\n      });\n      var statuses = _underscore2.default.map(associatedPoints, function (p) {\n        var currentData = _this6.getCurrentData(p.feature.properties.data);\n        return STATUSES.indexOf(_this6.getQualityStatus(currentData));\n      });\n      var worstStatusText = STATUSES[_underscore2.default.max(statuses)];\n      area.setStyle({\n        // Assumes that data is sorted with more recent date at last position\n        fillColor: COLORS[worstStatusText],\n        fillOpacity: 0.9\n      });\n    }\n  }, {\n    key: \"updateMarker\",\n    value: function updateMarker(marker) {\n      var properties = marker.feature.properties;\n\n      var currentData = this.getCurrentData(properties.data);\n      var status = this.getQualityStatus(currentData);\n      var iconUrl = STATUSES_ICONS[status];\n      var icon = _leaflet2.default.icon({ iconUrl: iconUrl, iconSize: [25, 41], iconAnchor: [12, 40] });\n      marker.setIcon(icon);\n      var popupContent = this.generateMarkerPopup(status, currentData, properties);\n\n      var popup;\n      if (!marker._popup) {\n        popup = marker._popup ? marker._popup : _leaflet2.default.popup({ maxWidth: 450 });\n        marker.bindPopup(popup);\n      } else {\n        popup = marker._popup.setContent(popupContent);\n      }\n      popup.setContent(popupContent);\n      popup.update();\n    }\n  }, {\n    key: \"generateMarkerPopup\",\n    value: function generateMarkerPopup(status, currentData, _ref) {\n      var data = _ref.data,\n          name = _ref.name;\n\n      if (currentData === null) return \"<div class=\\\"map-popup\\\"><h4 class=\\\"point-name\\\">Point \" + name + \"</h4>Aucune donn\\xE9e pour ce point pour le mois s\\xE9lectionn\\xE9</div>\";\n      return \"<div class=\\\"map-popup\\\">\\n      <h4 class=\\\"point-name\\\">Point \" + name + \"</h4>\\n      <p>\\n        Le <b>\" + currentData.date.replace(\" \", \" à \") + \"</b> le niveau de pollution\\n        pour ce point \\xE9tait <b style=\\\"color: \" + COLORS[status] + \";\\\">\" + status + \"</b>.\\n      </p>\\n      \" + this.generateHtmlTableForData(currentData, data) + \"\\n    </div>\";\n    }\n  }, {\n    key: \"generateHtmlTableForData\",\n    value: function generateHtmlTableForData(currentData, allData) {\n      var dataIdx = _underscore2.default.findLastIndex(allData, currentData);\n      var lines = [];\n\n      for (var i = dataIdx; i > dataIdx - POPUP_HISTORY_TABLE_SIZE && i >= 0; i--) {\n        var data = allData[i];\n        var escherichiaColiStatus = this.getEscherichiaColiStatus(data.escherichia_coli);\n        var intestinalEnterococciStatus = this.getIntestinalEnterococciStatus(data.intestinal_enterococci);\n        lines.push(\"<tr>\\n        <td>\" + data.date + \"</td>\\n        <td style=\\\"color: \" + COLORS[escherichiaColiStatus] + \";\\\">\\n          \" + data.escherichia_coli + \"\\n        </td>\\n        <td style=\\\"color: \" + COLORS[intestinalEnterococciStatus] + \";\\\">\\n          \" + data.intestinal_enterococci + \"\\n        </td>\\n      </tr>\");\n      }\n      return \"<table class=\\\"all-data\\\">\\n      <thead>\\n        <th>Date du pr\\xE9l\\xE8vement</th>\\n        <th>Escherichia coli (NPP/100ml)</th>\\n        <th>Ent\\xE9rocoques intestinaux (NPP/100ml)</th>\\n      <thead>\\n      <tbody>\\n        \" + lines.join('') + \"\\n      </tbody>\\n    </table>\";\n    }\n  }, {\n    key: \"getCurrentData\",\n    value: function getCurrentData(data) {\n      var _this7 = this;\n\n      // Get latest feature data for selected month\n      var lastDataForSelectedMonth = _underscore2.default.findLastIndex(data, function (_ref2) {\n        var date = _ref2.date;\n\n        var dataYearMonth = _this7.getYearMonthDateFromFrDatetimeStr(date);\n        return _this7.isSameMonthOrBefore(dataYearMonth, _this7.selectedDate);\n      });\n      return lastDataForSelectedMonth === -1 ? null : data[lastDataForSelectedMonth];\n    }\n  }, {\n    key: \"isSameMonthOrBefore\",\n    value: function isSameMonthOrBefore(date1, date2) {\n      return date1.getYear() <= date2.getYear() && date1.getMonth() <= date2.getMonth();\n    }\n  }, {\n    key: \"getQualityStatus\",\n    value: function getQualityStatus(data) {\n      if (data === null) return STATUS_OUTDATED;\n      // Dangerousity threshold as defined by the DASS (french health comitee)\n      // Get status for both bacteria, select the worst status\n      var escherichiaColiStatus = this.getEscherichiaColiStatus(data.escherichia_coli);\n      var intestinalEnterococciStatus = this.getIntestinalEnterococciStatus(data.intestinal_enterococci);\n\n      var worstStatusIdx = Math.max(STATUSES.indexOf(escherichiaColiStatus), STATUSES.indexOf(intestinalEnterococciStatus));\n      return STATUSES[worstStatusIdx];\n    }\n  }, {\n    key: \"getEscherichiaColiStatus\",\n    value: function getEscherichiaColiStatus(value) {\n      if (value <= 100) return STATUS_GOOD;else if (value <= 1000) return STATUS_AVERAGE;else if (value <= 2000) return STATUS_BAD;else if (value > 2000) return STATUS_DANGEROUS;else return STATUS_OUTDATED;\n    }\n  }, {\n    key: \"getIntestinalEnterococciStatus\",\n    value: function getIntestinalEnterococciStatus(value) {\n      if (value <= 100) return STATUS_GOOD;else if (value <= 370) return STATUS_AVERAGE;else if (value > 370) return STATUS_BAD;else return STATUS_OUTDATED;\n    }\n  }]);\n\n  return NoumeaWaterQualityMap;\n}(_react2.default.Component);\n\nexports.default = NoumeaWaterQualityMap;\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require(\"react-dom\");\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _leaflet = require(\"leaflet\");\n\nvar _leaflet2 = _interopRequireDefault(_leaflet);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar MENU_BAR_SIZE = 50;\nvar MAP_ID = \"main-map\";\nvar OSM_URL = 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';\nvar OSM_ATTRIB = 'Map data © <a href=\"http://openstreetmap.org\">OpenStreetMap</a> contributors';\n\nvar OsmMap = function (_React$Component) {\n  _inherits(OsmMap, _React$Component);\n\n  function OsmMap(props) {\n    _classCallCheck(this, OsmMap);\n\n    var _this = _possibleConstructorReturn(this, (OsmMap.__proto__ || Object.getPrototypeOf(OsmMap)).call(this, props));\n\n    _this.state = { height: 0 };\n    return _this;\n  }\n\n  _createClass(OsmMap, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.resetHeight();\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // Reset map container height on window resize\n      window.addEventListener(\"resize\", this.resetHeight.bind(this));\n\n      // Initialize map\n      var _props = this.props,\n          minZoom = _props.minZoom,\n          initialZoom = _props.initialZoom,\n          initialLocation = _props.initialLocation,\n          bounds = _props.bounds;\n\n      this.map = _leaflet2.default.map(MAP_ID);\n      var osm = new _leaflet2.default.TileLayer(OSM_URL, {\n        minZoom: minZoom,\n        maxZoom: 18,\n        attribution: OSM_ATTRIB\n      });\n      this.map.setView(initialLocation, initialZoom);\n      if (bounds != null) this.map.setMaxBounds(bounds);\n      this.map.addLayer(osm);\n    }\n  }, {\n    key: \"addGeoJson\",\n    value: function addGeoJson(geoJSON, geoJSONParams) {\n      this.geoJSONLayer = _leaflet2.default.geoJSON(geoJSON, geoJSONParams).addTo(this.map);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener(\"resize\", this.resetHeight.bind(this));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return _react2.default.createElement(\"div\", { id: MAP_ID, style: { height: this.state.height } });\n    }\n  }, {\n    key: \"resetHeight\",\n    value: function resetHeight() {\n      this.setState({ height: window.innerHeight - MENU_BAR_SIZE });\n    }\n  }]);\n\n  return OsmMap;\n}(_react2.default.Component);\n\nexports.default = OsmMap;\n\n\nOsmMap.defaultProps = {\n  initialLocation: new _leaflet2.default.LatLng(0, 0),\n  initialZoom: 1,\n  bounds: [[-22.33, 166.28], [-22.18, 166.61]],\n  geoJSON: null,\n  geoJSONParams: {},\n  minZoom: 1\n};\n","\"use strict\";\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require(\"react-dom\");\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _NavMenu = require(\"./components/NavMenu\");\n\nvar _NavMenu2 = _interopRequireDefault(_NavMenu);\n\nvar _NoumeaWaterQualityMap = require(\"./components/NoumeaWaterQualityMap\");\n\nvar _NoumeaWaterQualityMap2 = _interopRequireDefault(_NoumeaWaterQualityMap);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n_reactDom2.default.render(_react2.default.createElement(_NavMenu2.default, null), document.getElementById('nav-menu'));\n\n_reactDom2.default.render(_react2.default.createElement(_NoumeaWaterQualityMap2.default, null), document.getElementById('map-container'));\n"]}